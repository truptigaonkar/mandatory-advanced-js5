(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,a){},53:function(e,t,a){e.exports=a.p+"static/media/logo.7c908eb4.png"},57:function(e,t,a){e.exports=a(99)},62:function(e,t,a){},64:function(e,t,a){},89:function(e,t,a){},98:function(e,t,a){},99:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(20),o=a.n(r),c=(a(62),a(63),a(12)),i=a(19),u=(a(64),a(7)),s=a(10),m=a(44),f=a(41),d="708xp4tm8gf03u3",p=a(122),b=new p.a(window.localStorage.getItem("token"));function h(e){e?window.localStorage.setItem("token",e):window.localStorage.removeItem("token"),b.next(e)}var E=new p.a(JSON.parse(window.localStorage.getItem("favorites"))||[]);function v(e){var t=JSON.stringify(e);window.localStorage.setItem("favorites",t),E.next(e)}var g={marginTop:"60px"},O={marginTop:"30px"};function y(e){var t=Object(n.useState)(b.value),a=Object(u.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)(function(){var e=b.subscribe(o);return function(){return e.unsubscribe()}},[]),r?l.a.createElement(i.a,{to:"/home"}):l.a.createElement(l.a.Fragment,null,l.a.createElement(f.Helmet,null,l.a.createElement("title",null,"Start")),l.a.createElement("h3",{style:g},"File Hosting Service"),l.a.createElement(m.a,{color:"success",onClick:function(e){console.log(d);var t=new s.Dropbox({clientId:d}).getAuthenticationUrl("https://ayumina.github.io/mandatory-advanced-js5/auth");console.log(t),window.location.href=t},style:O},"Connect")," ")}var w=a(46),j=a.n(w);function k(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)(function(){var t=e.location;h(j.a.parse(t.hash).access_token),o(!0)},[]),r?l.a.createElement(i.a,{to:"/home"}):l.a.createElement("p",null,"Redirecting...")}var x=a(115),C=a(116),S=a(117),T=a(118),D=a(119),F=a(120),B=a(121),_=(a(87),a(54)),A=(a(37),a(112)),M=a(113),N=a(101),U=a(102);var I=function(e){var t="",a=e.path.substring(1).split("/"),n=a.map(function(e,n){return t+="/".concat(e),l.a.createElement(N.a,{active:n===a.length-1,tag:"a",href:t},0===n?"Home":e)});return l.a.createElement(U.a,null,n)},R=a(47),z=a(48),L=a(56),J=a(49),G=a(24),H=a(55),W=a(108),P=a(109),K=a(110),Y=a(111),Z=(a(89),a(123)),$=a(103),q=a(104),V=a(105),Q=a(106),X=a(107),ee=function(e){var t=Object(n.useState)(e.toggle),a=Object(u.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(e.file),i=Object(u.a)(c,2),f=i[0],d=(i[1],Object(n.useState)([])),p=Object(u.a)(d,2),h=p[0],g=p[1];function O(){o(!r)}return l.a.createElement(l.a.Fragment,null,l.a.createElement(Z.a,{isOpen:r,toggle:O,modalTransition:{timeout:700},backdropTransition:{timeout:1300}},l.a.createElement($.a,{toggle:O},"Delete file/folder"),l.a.createElement(q.a,null,l.a.createElement(V.a,null,l.a.createElement(Q.a,null,'Are you sure want to delete "',f&&f.name,'"?'))),l.a.createElement(X.a,null,l.a.createElement(m.a,{color:"danger",onClick:function(){return function(t){new s.Dropbox({accessToken:b.value,fetch:fetch}).filesDeleteV2({path:f.path_lower}).then(function(a){console.log("delete response: ",a);var n=h.filter(function(e){return t!==e});g(n),e.onDelete(),O()}).catch(function(e){console.error(e)});var a=t.id;v(E.value.filter(function(e){return e.id!==a}))}(e.file)}},"Delete")," ",l.a.createElement(m.a,{color:"secondary",onClick:O},"Cancel"))))},te=function(e){function t(e){var a;return Object(R.a)(this,t),(a=Object(L.a)(this,Object(J.a)(t).call(this,e))).state={dropdownOpen:!1,file:e.file,deleteModal:!1,onDelete:e.onDelete},a.toggle=a.toggle.bind(Object(G.a)(a)),a.deleteToggle=a.deleteToggle.bind(Object(G.a)(a)),a}return Object(H.a)(t,e),Object(z.a)(t,[{key:"toggle",value:function(){this.setState(function(e){return{dropdownOpen:!e.dropdownOpen}})}},{key:"deleteToggle",value:function(){this.setState(function(e){return{deleteModal:!e.deleteModal}})}},{key:"handleCopy",value:function(e){var t=e.path_lower;new s.Dropbox({accessToken:b.value,fetch:fetch}).filesCopy({from_path:t,to_path:t,allow_shared_folder:!0,autorename:!0})}},{key:"render",value:function(){var e=this;return l.a.createElement(W.a,{isOpen:this.state.dropdownOpen,toggle:this.toggle},l.a.createElement(P.a,{color:"primary",outline:!0,caret:!0},l.a.createElement("i",{class:"material-icons"},"more_horiz")),l.a.createElement(K.a,null,l.a.createElement(Y.a,{onClick:this.deleteToggle},l.a.createElement(ee,{file:this.state.file,toggle:this.state.deleteModal,onDelete:this.state.onDelete}),"Delete"),l.a.createElement(Y.a,null,"Rename"),l.a.createElement(Y.a,null,"Move"),l.a.createElement(Y.a,{onClick:function(){return e.handleCopy(e.state.file)}},"Copy")))}}]),t}(n.Component);function ae(e){return l.a.createElement("i",{class:"material-icons",id:e.id,onClick:e.onClickAddFavorite},"star_border")}function ne(e){return l.a.createElement("i",{class:"material-icons",id:e.id,onClick:e.onClickRemoveFavorite},"star")}var le=/\.(gif|jpg|jpeg|tiff|tif|png|bmp)$/i,re=function(e){var t=Object(n.useState)(""),a=Object(u.a)(t,2),r=a[0],o=a[1];return Object(n.useEffect)(function(){le.test(e.file.name)&&new s.Dropbox({accessToken:b.value,fetch:fetch}).filesGetThumbnail({path:e.file.path_lower,size:"w32h32"}).then(function(e){var t=URL.createObjectURL(e.fileBlob);o(t)}).catch(function(e){console.error(e)})},[e.file.name,e.file.path_lower]),le.test(e.file.name)?l.a.createElement("img",{src:r,alt:e.file.name}):"file"===e.file[".tag"]?l.a.createElement("i",{class:"material-icons"},"insert_drive_file"):"folder"===e.file[".tag"]?l.a.createElement("i",{class:"material-icons"},"folder"):null};var oe=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),r=(a[0],a[1],Object(n.useState)(E.value)),o=Object(u.a)(r,2),i=o[0],m=o[1],f=Object(n.useState)(""),d=Object(u.a)(f,2),p=d[0],h=d[1],g=Object(n.useState)(b.value),O=Object(u.a)(g,2),y=O[0],w=(O[1],Object(n.useState)("")),j=Object(u.a)(w,2),k=(j[0],j[1],e.location.pathname.substring(5)),x=e.updateData;function C(t){var a,n=t.target.id,l=!0,r=!1,o=void 0;try{for(var c,u=e.data[Symbol.iterator]();!(l=(c=u.next()).done);l=!0){var s=c.value;s.id===n&&(a=Object(_.a)({},s))}}catch(f){r=!0,o=f}finally{try{l||null==u.return||u.return()}finally{if(r)throw o}}var m=i.slice();m.push(a),v(m)}function S(e){var t=e.target.id;v(i.filter(function(e){return e.id!==t}))}return Object(n.useEffect)(function(){if(y){var e=new s.Dropbox({accessToken:y});p&&e.filesSearch({path:"",query:p}).then(function(e){var t=e.matches.map(function(e){return e.metadata});x(t)})}},[y,p,k]),Object(n.useEffect)(function(){var e=E.subscribe(m);return function(){return e.unsubscribe()}},[]),l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{style:{position:"relative",width:"100%"}},l.a.createElement(I,{path:e.location.pathname}),l.a.createElement(A.a,{type:"text",size:"lg",placeholder:"Search",onChange:function(e){h(e.target.value)},value:e.search,style:{position:"absolute",width:"30%",minWidth:"150px",right:"0px",top:"-1px"}})),l.a.createElement(M.a,null,l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Type"),l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Last modified"),l.a.createElement("th",null,"Size"),l.a.createElement("th",null,"Menu"),l.a.createElement("th",null,l.a.createElement("i",{class:"material-icons"},"star_border")))),l.a.createElement("tbody",null,e.data.map(function(t){var a=!1,n=!0,r=!1,o=void 0;try{for(var u,m=i[Symbol.iterator]();!(n=(u=m.next()).done);n=!0)if(u.value.id===t.id){a=!0;break}}catch(f){r=!0,o=f}finally{try{n||null==m.return||m.return()}finally{if(r)throw o}}return l.a.createElement("tr",{key:t.id},l.a.createElement("td",{style:{color:"green"}},l.a.createElement(re,{file:t})),l.a.createElement("td",null,"folder"===t[".tag"]?l.a.createElement(c.b,{to:"/home".concat(t.path_display)},t.name):l.a.createElement("span",{onClick:function(){return t.name,e=t.path_display,void new s.Dropbox({accessToken:b.value,fetch:fetch}).filesDownload({path:e}).then(function(e){console.log("File details to be download: ",e);var t=URL.createObjectURL(e.fileBlob),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",e.name),a.click()}).catch(function(e){console.log(e.response)});var e},style:{cursor:"pointer",color:"blue"}},t.name)),l.a.createElement("td",null,t.server_modified?function(e){var t=e.substring(8,10),a=e.substring(5,7),n=e.substring(0,4);a=a.replace(/^0+/,""),t=t.replace(/^0+/,"");var r=["January","February","March","April","May","June","July","August","September","October","November","December"][a-1];return l.a.createElement("label",null,t+" "+r+" "+n)}(t.server_modified):null),l.a.createElement("td",null,function(e){for(var t=[" B"," KB"," MB"," GB"," TB"," PB"," EB"," ZB"," YB"],a=1;a<t.length;a++)if(e<Math.pow(1024,a))return Math.round(e/Math.pow(1024,a-1)*100)/100+t[a-1];return e}(t.size)),l.a.createElement("td",null,l.a.createElement(te,{file:t,onDelete:e.onDelete})),l.a.createElement("td",null,a?l.a.createElement(ne,{id:t.id,onClickRemoveFavorite:S}):l.a.createElement(ae,{id:t.id,onClickAddFavorite:C})))}))))},ce=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(""),i=Object(u.a)(c,2),f=i[0],d=i[1],p=e.location.pathname.substring(5);function h(){o(!0)}function E(){o(!1)}return l.a.createElement(l.a.Fragment,null,l.a.createElement(m.a,{onClick:h},"New Folder"),l.a.createElement(Z.a,{isOpen:r,toggle:h,modalTransition:{timeout:700},backdropTransition:{timeout:1300}},l.a.createElement($.a,{toggle:E},"Create New Folder"),l.a.createElement(q.a,null,l.a.createElement(V.a,null,l.a.createElement(Q.a,{for:"name"},"Folder name"),l.a.createElement(A.a,{type:"text",placeholder:"Folder name",onChange:function(e){d(e.target.value)},value:f}))),l.a.createElement(X.a,null,l.a.createElement(m.a,{color:"success",onClick:function(){new s.Dropbox({accessToken:b.value,fetch:fetch}).filesCreateFolder({path:p+"/"+f,autorename:!0}).then(function(t){e.onNewFolder(t),E()}).catch(function(e){console.log(e.response)})}},"Create")," ",l.a.createElement(m.a,{color:"secondary",onClick:E},"Cancel"))))};function ie(e){var t=Object(n.useState)(b.value),a=Object(u.a)(t,2),r=(a[0],a[1]),o=Object(n.useState)(E.value),i=Object(u.a)(o,2),m=i[0],f=i[1],d=Object(n.useState)(""),p=Object(u.a)(d,2);p[0],p[1];function h(e){var t=e.target.id;v(m.filter(function(e){return e.id!==t}))}function g(t){e.updateActiveTab("1")}return Object(n.useEffect)(function(){document.title="Home"}),Object(n.useEffect)(function(){var e=b.subscribe(r);return function(){return e.unsubscribe()}},[]),Object(n.useEffect)(function(){var e=E.subscribe(f);return function(){return e.unsubscribe()}},[]),l.a.createElement(l.a.Fragment,null,l.a.createElement(M.a,{style:{marginTop:"1em"}},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Type"),l.a.createElement("th",null,"Name"),l.a.createElement("th",null,"Last modified"),l.a.createElement("th",null,"Size"),l.a.createElement("th",null))),l.a.createElement("tbody",null,m.map(function(e){return l.a.createElement("tr",{key:e.id},l.a.createElement("td",{style:{color:"green"}},l.a.createElement(re,{file:e})),l.a.createElement("td",null,"folder"===e[".tag"]?l.a.createElement(c.b,{to:"/home".concat(e.path_display),onClick:g},e.name):l.a.createElement("span",{onClick:function(){return e.name,t=e.path_display,void new s.Dropbox({accessToken:b.value,fetch:fetch}).filesDownload({path:t}).then(function(e){console.log("File details to be download: ",e);var t=URL.createObjectURL(e.fileBlob),a=document.createElement("a");a.setAttribute("href",t),a.setAttribute("download",e.name),a.click()}).catch(function(e){console.log(e.response)});var t},style:{cursor:"pointer",color:"blue"}},e.name)),l.a.createElement("td",null,e.server_modified?function(e){var t=e.substring(8,10),a=e.substring(5,7),n=e.substring(0,4);a=a.replace(/^0+/,""),t=t.replace(/^0+/,"");var r=["January","February","March","April","May","June","July","August","September","October","November","December"][a-1];return l.a.createElement("label",null,t+" "+r+" "+n)}(e.server_modified):null),l.a.createElement("td",null,function(e){for(var t=[" B"," KB"," MB"," GB"," TB"," PB"," EB"," ZB"," YB"],a=1;a<t.length;a++)if(e<Math.pow(1024,a))return Math.round(e/Math.pow(1024,a-1)*100)/100+t[a-1];return e}(e.size)),l.a.createElement("td",null,l.a.createElement("button",{id:e.id,onClick:h},"Remove from favorites")))}))))}var ue=a(114);var se=function(e){var t=Object(n.useState)(b.value),a=Object(u.a)(t,2),r=a[0],o=(a[1],Object(n.useState)(!1)),c=Object(u.a)(o,2),i=c[0],f=c[1],d=Object(n.useState)(null),p=Object(u.a)(d,2),h=p[0],E=p[1],v=e.location.pathname.substring(5);function g(){f(!i)}function O(t){t.preventDefault(),function(t){var a=new s.Dropbox({accessToken:r,fetch:fetch});t.size>0&&t.size<15e7&&a.filesUpload({contents:t,path:"".concat(v,"/").concat(t.name)}).then(function(t){e.onUpload(),f(!1)}).catch(function(e){console.error(e)})}(h),f(!1)}return l.a.createElement(l.a.Fragment,null,l.a.createElement(m.a,{onClick:g},"Upload File"),l.a.createElement(Z.a,{isOpen:i,toggle:g,modalTransition:{timeout:700},backdropTransition:{timeout:1300}},l.a.createElement($.a,{toggle:g},"Upload file"),l.a.createElement(q.a,null,l.a.createElement(V.a,{id:"upload"},l.a.createElement(Q.a,{htmlFor:"uploadfile",id:"uploadLabel"},"Please select a file to upload"),l.a.createElement(A.a,{type:"file",name:"file",id:"uploadfile",onChange:function(e){E(e.target.files[0]||null)}}),l.a.createElement(ue.a,{color:"muted"},"The size of a file should not exceed 150MB."))),l.a.createElement(X.a,null,l.a.createElement(m.a,{htmlFor:"upload",type:"submit",color:"success",disabled:null===h,onClick:function(e){return O(e)}},"Upload")," ",l.a.createElement(m.a,{color:"secondary",onClick:g},"Cancel"))))},me=(a(98),{margin:"41px 6px 0 6px",width:"20%",minWidth:"50px"}),fe={listStyle:"none",padding:"0"},de={marginTop:"15px",padding:"0",fontSize:"large"},pe={position:"absolute",right:"10px",top:"10px"},be={marginRight:"5px",verticalAlign:"baseline"};var he=function(e){return l.a.createElement("aside",{style:me},l.a.createElement("ul",{style:fe},l.a.createElement("li",{className:"menu",style:de},l.a.createElement(se,{onUpload:e.onUpload,location:e.location,file:e.file})),l.a.createElement("li",{className:"menu",style:de},l.a.createElement(ce,{onNewFolder:e.onNewFolder,location:e.location}))),l.a.createElement("div",{style:pe},l.a.createElement("span",{style:be},e.user),l.a.createElement(m.a,{color:"success",onClick:e.logOut},"Log out")))};var Ee=function(e){var t=Object(n.useState)(b.value),a=Object(u.a)(t,2),r=a[0],o=a[1],m=Object(n.useState)([]),f=Object(u.a)(m,2),d=f[0],p=f[1],v=Object(n.useState)(""),g=Object(u.a)(v,2),O=g[0],y=g[1],w=Object(n.useState)("/home/favorites"===e.location.pathname?"2":"1"),j=Object(u.a)(w,2),k=j[0],_=j[1],A=e.location.pathname.substring(5);function M(){if("/favorites"!==A){var e=new s.Dropbox({accessToken:r,fetch:fetch});"/"===A&&(A=""),e.filesListFolder({path:A}).then(function(e){p(e.entries)}).catch(function(e){console.error(e)})}}return Object(n.useEffect)(function(){document.title="TeaCup"}),Object(n.useEffect)(function(){var e=b.subscribe(o);return function(){return e.unsubscribe()}}),Object(n.useEffect)(function(){var e=setInterval(function(){M()},3e3);return function(){return clearInterval(e)}},[A]),Object(n.useEffect)(function(){new s.Dropbox({accessToken:r}).usersGetCurrentAccount().then(function(e){y(e.name.given_name)}).catch(function(e){console.error(e)})},[r]),r?l.a.createElement("div",{style:{display:"flex",width:"100%"}},l.a.createElement("div",{style:{flexGrow:1}},l.a.createElement(x.a,{tabs:!0},l.a.createElement(C.a,null,l.a.createElement(c.b,{to:"/home"},l.a.createElement(S.a,{className:"1"===k?"active":"",onClick:function(){return _("1")},style:{color:"#31572C"}},l.a.createElement("i",{class:"material-icons",style:{verticalAlign:"bottom"}},"folder"),"All"))),l.a.createElement(C.a,null,l.a.createElement(c.b,{to:"/home/favorites"},l.a.createElement(S.a,{className:"2"===k?"active":"",onClick:function(){_("2")},style:{color:"#31572C"}},l.a.createElement("i",{class:"material-icons",style:{verticalAlign:"bottom"}},"star"),"Favorites")))),l.a.createElement(T.a,{activeTab:k},l.a.createElement(D.a,{tabId:"1"},l.a.createElement(F.a,null,l.a.createElement(B.a,{sm:"12"})),l.a.createElement(F.a,null,l.a.createElement(B.a,{sm:"12"},l.a.createElement(oe,{location:e.location,data:d,updateData:p,renderData:M,onDelete:function(){M()}})))),l.a.createElement(D.a,{tabId:"2"},l.a.createElement(F.a,null,l.a.createElement(B.a,{sm:"12"},l.a.createElement(i.b,{path:"/home/favorites",render:function(e){return l.a.createElement(ie,Object.assign({activeTab:k,updateActiveTab:_},e))}})))))),l.a.createElement(he,{location:e.location,logOut:function(e){e.preventDefault(),new s.Dropbox({accessToken:b.value,fetch:fetch}).authTokenRevoke(),h(null),window.localStorage.removeItem("favorites"),E.next(null)},user:O,onNewFolder:function(e){M()},onUpload:function(){M()}})):l.a.createElement(i.a,{to:"/"})},ve=a(53),ge=a.n(ve),Oe={width:"100%",height:"80px",margin:"10px 0 0 0",display:"flex",justifyContent:"flex-start",alignItems:"flex-end"},ye={width:"50px",position:"absolute",left:"10px",top:"8px"},we={margin:0,position:"absolute",left:"64px",top:"24px",color:"#212529"};var je=function(){return l.a.createElement("div",{className:"App"},l.a.createElement(c.a,{basename:"/mandatory-advanced-js5"},l.a.createElement("nav",{style:Oe},l.a.createElement(c.b,{to:"/"},l.a.createElement("img",{src:ge.a,style:ye})),l.a.createElement("h1",{style:we},"TeaCup")),l.a.createElement(i.b,{exact:!0,path:"/",component:y}),l.a.createElement(i.b,{path:"/auth",component:k}),l.a.createElement(i.b,{path:"/home",component:Ee})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(je,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[57,1,2]]]);
//# sourceMappingURL=main.71148f1d.chunk.js.map